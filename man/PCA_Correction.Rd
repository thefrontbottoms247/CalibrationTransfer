% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/PCA_Correction.R
\name{PCA_Correction}
\alias{PCA_Correction}
\title{Stabilized Thin-Plate Dynamic PCA Correction}
\usage{
PCA_Correction(
  pca_parent,
  pca_child,
  ncomp = 2,
  lambda = 0.01,
  radial_quantile = 0.85,
  angle_quantile = 0.765,
  pc1_anisotropy = 0.5,
  blend_scale = 1.5,
  max_blend = 0.4,
  min_blend = 0.05
)
}
\arguments{
\item{pca_parent}{Parent PCA object (prcomp)}

\item{pca_child}{Child PCA object (prcomp)}

\item{ncomp}{Number of principal components to correct (default = 2)}

\item{lambda}{Smoothing parameter for thin-plate splines (default = 0.01)}

\item{radial_quantile}{Quantile for radial damping threshold (default = 0.85)}

\item{angle_quantile}{Quantile for angular damping threshold (default = 0.765)}

\item{pc1_anisotropy}{Strength of PC1 anisotropic damping (default = 0.5)}

\item{blend_scale}{Scaling factor for adaptive blending (default = 1.5)}

\item{max_blend}{Maximum blending weight (default = 0.4)}

\item{min_blend}{Minimum blending weight (default = 0.05)}
}
\value{
List containing:
\item{child_corrected}{Corrected child PCA scores}
\item{diagnostics}{Data frame with intermediate values for diagnostics}
\item{models}{List of fitted TPS models for each coordinate}
}
\description{
Corrects child PCA scores to align with parent PCA using hyperspherical
coordinates and thin-plate spline smoothing. Supports arbitrary dimensions.
}
\examples{
\dontrun{
library(fields)
result <- pca_tps_correct(parent.pca, child.pca, ncomp = 3)
child.pca_cor <- result$child_corrected
}

}
