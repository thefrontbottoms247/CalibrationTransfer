% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Generalized Least Squares Weighting.R
\name{GLSW}
\alias{GLSW}
\title{Generalized Least Squares Weighting (GLSW)}
\usage{
GLSW(X_S, Y_S, X_T, ncomp = 5)
}
\arguments{
\item{X_S}{A numeric matrix or data frame of source (reference) spectra.}

\item{Y_S}{A numeric vector of reference concentrations corresponding to \code{X_S}.}

\item{X_T}{A numeric matrix or data frame of target (secondary) spectra.}

\item{ncomp}{Integer. Number of PLS components to use (default = 5).}
}
\value{
A list containing:
\describe{
\item{\code{W}}{Weighting matrix derived from covariance ratio.}
\item{\code{pls_model}}{Trained PLS model on weighted source data.}
\item{\code{Y_pred}}{Predictions on weighted target data.}
\item{\code{X_S_weighted}}{Weighted source spectra.}
\item{\code{X_T_weighted}}{Weighted target spectra.}
}
}
\description{
Performs generalized least squares weighting between spectra from
source and target instruments to compensate for inter-instrumental variance.
This method computes a weighting matrix based on the covariance structure
of the source and target datasets and applies it to correct the source spectra.
}
\details{
The weighting matrix is computed as:
\deqn{W = cov(X_S)^{-1} cov(X_T)}
where \eqn{cov(X_S)} and \eqn{cov(X_T)} are covariance matrices
of source and target spectra, respectively. The generalized inverse
(\code{MASS::ginv}) is used to ensure numerical stability.
}
\examples{
\dontrun{
result <- GLSW(X_S = parent_spectra,
               Y_S = parent_conc,
               X_T = child_spectra,
               ncomp = 5)
result$Y_pred
}

}
