% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Nonlinear Piecewise Direct Standardization.R
\name{NPDS}
\alias{NPDS}
\title{Nonlinear Piecewise Direct Standardization (N-PDS)}
\usage{
NPDS(
  parent,
  child,
  child.mod = NULL,
  window = "static",
  model_type = "OLS",
  degree = 1,
  svm_kernel = "linear",
  base_window = 5,
  peak_window = 20,
  ncomp = 20,
  ncomp_svd = NULL,
  nonneg = FALSE
)
}
\arguments{
\item{parent}{Numeric matrix or data frame of reference spectra (n × p).}

\item{child}{Numeric matrix or data frame of target spectra (n × p).}

\item{child.mod}{Optional data frame of child spectra to be corrected,
with a \code{Class} column as the last variable.}

\item{window}{Character; "static" or "dynamic" window definition method.}

\item{model_type}{Character; regression type ("OLS", "Ridge", "Lasso",
"PLSR", "PCR", or "SVM").}

\item{degree}{Integer; polynomial degree for nonlinear expansion (default = 1).}

\item{svm_kernel}{Character; SVM kernel type ("linear", "polynomial", "radial").}

\item{base_window}{Integer; base window size for static or non-peak regions.}

\item{peak_window}{Integer; window size for dynamic peak regions.}

\item{ncomp}{Integer; number of components for latent variable models.}

\item{ncomp_svd}{Optional numeric vector of component counts per variable.}

\item{nonneg}{Logical; whether to enforce non-negativity on regression coefficients.}
}
\value{
A list containing:
\item{P}{Sparse coefficient matrix (p × p).}
\item{intercept}{Intercept vector (length p).}
\item{child.mod_cor}{Corrected dataset if \code{child.mod} supplied.}
}
\description{
Extends classical Piecewise Direct Standardization (PDS) by allowing
nonlinear, regularized, and machine-learning-based regressions within each
local wavelength window. Supports polynomial feature expansion, SVM kernels,
and non-negativity constraints.
}
\details{
When \code{model_type} is one of "OLS", "Ridge", "Lasso", "PLSR", or "PCR",
this function behaves as classical PDS. When using \code{degree > 1} or
\code{model_type = 'SVM'}, it performs nonlinear piecewise regression approximating
the parent–child transfer function.
}
\seealso{
\code{\link[=PDS]{PDS()}} for the strictly linear implementation.
}
