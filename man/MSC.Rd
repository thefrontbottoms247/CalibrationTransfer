% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Multiplicative Scatter Correction.R
\name{MSC}
\alias{MSC}
\title{MSC correction within samples (in-place, global assignment)}
\usage{
MSC(data, class_vec, scans_per_sample)
}
\arguments{
\item{data}{matrix \link{n_scans x n_wavelengths}; each row = one scan}

\item{class_vec}{vector of length n_scans giving the class label for each scan}

\item{scans_per_sample}{integer; number of scans per sample (e.g. 5)}
}
\description{
Performs Multiplicative Scatter Correction (MSC) on a full dataset,
correcting each scan using the mean spectrum of its own sample as reference.
The input matrix \code{data} is overwritten globally with its corrected values.
}
\details{
For each sample, its mean spectrum is computed and used as the reference.
Each scan in that sample is linearly adjusted: (scan - a) / b,
where a and b come from lm(scan ~ ref). This removes additive and
multiplicative differences between scans within the same sample.
}
