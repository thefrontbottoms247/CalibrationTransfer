% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Correlation Piecewise Direct Standardization.R
\name{CPDS}
\alias{CPDS}
\title{CPDS: Combined (C)ORAL and (P)iecewise (D)irect (S)tandardization}
\usage{
CPDS(
  parent,
  child,
  child.mod = NULL,
  order = c("PDS->CORAL", "CORAL->PDS", "local-CORAL-PDS"),
  window = "static",
  base_window = 5,
  peak_window = 20,
  model_type = "OLS",
  ncomp = 20,
  nonneg = FALSE,
  coral_method = "auto",
  coral_center = TRUE,
  coral_scale = FALSE,
  coral_lambda = 1e-06
)
}
\arguments{
\item{parent}{matrix/data.frame; reference spectra.}

\item{child}{matrix/data.frame; target spectra to learn mapping from.}

\item{child.mod}{optional data frame of child spectra to correct; last column may be Class.}

\item{order}{one of c("PDS->CORAL","CORAL->PDS","local-CORAL-PDS").}

\item{window}{"static" or "dynamic" PDS windows. For "dynamic" a global \code{peaks} integer vector must exist.}

\item{base_window}{integer; base PDS window size.}

\item{peak_window}{integer; dynamic peak window size.}

\item{model_type}{"OLS","Ridge","Lasso","PLSR","PCR".}

\item{ncomp}{integer; components for PLSR/PCR.}

\item{nonneg}{logical; enforce non-negativity in linear models where applicable.}

\item{coral_method}{"auto","full","svd".}

\item{coral_center}{logical; CORAL centering.}

\item{coral_scale}{logical; CORAL variance scaling.}

\item{coral_lambda}{numeric; CORAL ridge.}
}
\value{
list with elements:
\item{X_child_aligned}{transformed child (training) spectra}
\item{P}{sparse PDS coefficient matrix (if PDS used)}
\item{intercept}{PDS intercept vector (if PDS used)}
\item{A}{global CORAL transform (if used)}
\item{child.mod_cor}{corrected child.mod if supplied}
}
\description{
Flexible pipeline for calibration transfer:
\itemize{
\item order = "PDS->CORAL": run PDS, then global CORAL on the PDS output.
\item order = "CORAL->PDS": global CORAL first, then PDS.
\item order = "local-CORAL-PDS": CORAL whitening/recoloring inside each PDS window.
}
}
